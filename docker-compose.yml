version: '2.4'
volumes:
  logs: {}
  config: {}
  data: {}
  wheel-cache: {}

services:
  # bluetooth:
  #   image: bh.cr/balenalabs/bluetooth-rpi
  #   labels:
  #     io.balena.features.dbus: '1'
  #   cap_add:
  #     - NET_ADMIN
  #   restart: on-failure
  #   network_mode: host

  smartsolar:
    build: ./smartsolar
    # depends_on:
    #   - bluetooth
    restart: on-failure
    environment:
      - TZ=UTC
      - DBUS_SYSTEM_BUS_ADDRESS=unix:path=/host/run/dbus/system_bus_socket
    volumes:
      - logs:/var/log
      - data:/data
      - wheel-cache:/wheel-cache
    network_mode: host
    privileged: true
    labels:
      io.balena.features.dbus: '1'
      io.balena.features.kernel-modules: '1'
  